Library System
Use the following Schema to perform the given set of assignment.

Tables-
Member – It contains information about the members

| Column Name       | Data Type    | Description                                                          |
| ----------------- | ------------ | -------------------------------------------------------------------- |
| Member_Id         | Integer      | Unique Member ID                                                     |
| Member_Name       | Varchar(30)  | Name of the library member                                           |
| Member_Address    | Varchar(50)  | Address of the member                                                |
| Acc_Open_Date     | Date         | Date of membership opening                                           |
| Membership_Type   | Varchar(20)  | Type of membership: ‘Lifetime’, ‘Annual’, ‘Half Yearly’, ‘Quarterly’ |
| Fees_Paid         | Integer      | Membership fees paid                                                 |
| Max_Books_Allowed | Integer      | Total number of books the member can issue                           |
| Penalty_Amount    | Decimal(7,2) | Penalty amount due                                                   |

Books- It contains information about the books belongs to the library

| Column Name | Data Type    | Description                         |
| ----------- | ------------ | ----------------------------------- |
| Book_No     | Integer      | Book identification number          |
| Book_Name   | Varchar(30)  | Name of the book                    |
| Author_Name | Varchar(30)  | Author of the book                  |
| Cost        | Decimal(7,2) | Cost of the book                    |
| Category    | Char(10)     | Category like Science, Fiction etc. |

Issue – It contains the information about issue of the books

| Column Name  | Data Type | Description                |
| ------------ | --------- | -------------------------- |
| Lib_Issue_Id | Integer   | Library book issue number  |
| Book_No      | Integer   | Number of the issued book  |
| Member_Id    | Integer   | Member who issued the book |
| Issue_Date   | Date      | Date of book issue         |
| Return_Date  | Date      | Date of return             |


Task / Problems:

1) Create the table Member, Books and Issue without any constraints as
mentioned in the schema description above.

mysql> create table members
    -> (Member_id int,
    -> Member_Name varchar(30),
    -> Member_address varchar(50),
    -> Acc_Open_Date date,
    -> Membership_type varchar(20),
    -> Fees_paid int,
    -> Max_Books_Allowed int
    -> ,Penalty_Amount decimal(7,2));
Query OK, 0 rows affected (0.05 sec)

mysql> create table library
    -> (Book_No int,
    -> Book_Name varchar(30),
    -> Author_Name varchar(30),
    -> Cost decimal(7,2),
    -> Category char(10));
Query OK, 0 rows affected (0.04 sec)

mysql> create table issue
    -> (Lib_issue_id int,
    -> Book_no int,
    -> Member_id int,
    -> Issue_date date,
    -> Return_date date);
Query OK, 0 rows affected (0.07 sec)



2) View the structure of the tables.

mysql> desc members;
+-------------------+--------------+------+-----+---------+-------+
| Field             | Type         | Null | Key | Default | Extra |
+-------------------+--------------+------+-----+---------+-------+
| Member_id         | int          | YES  |     | NULL    |       |
| Member_Name       | varchar(30)  | YES  |     | NULL    |       |
| Member_address    | varchar(50)  | YES  |     | NULL    |       |
| Acc_Open_Date     | date         | YES  |     | NULL    |       |
| Membership_type   | varchar(20)  | YES  |     | NULL    |       |
| Fees_paid         | int          | YES  |     | NULL    |       |
| Max_Books_Allowed | int          | YES  |     | NULL    |       |
| Penalty_Amount    | decimal(7,2) | YES  |     | NULL    |       |
+-------------------+--------------+------+-----+---------+-------+
8 rows in set (0.04 sec)

mysql> desc library;
+-------------+--------------+------+-----+---------+-------+
| Field       | Type         | Null | Key | Default | Extra |
+-------------+--------------+------+-----+---------+-------+
| Book_No     | int          | YES  |     | NULL    |       |
| Book_Name   | varchar(30)  | YES  |     | NULL    |       |
| Author_Name | varchar(30)  | YES  |     | NULL    |       |
| Cost        | decimal(7,2) | YES  |     | NULL    |       |
| Category    | char(10)     | YES  |     | NULL    |       |
+-------------+--------------+------+-----+---------+-------+
5 rows in set (0.01 sec)

mysql> desc issue;
+--------------+------+------+-----+---------+-------+
| Field        | Type | Null | Key | Default | Extra |
+--------------+------+------+-----+---------+-------+
| Lib_issue_id | int  | YES  |     | NULL    |       |
| Book_no      | int  | YES  |     | NULL    |       |
| Member_id    | int  | YES  |     | NULL    |       |
| Issue_date   | date | YES  |     | NULL    |       |
| Return_date  | date | YES  |     | NULL    |       |
+--------------+------+------+-----+---------+-------+
5 rows in set (0.00 sec)


3) Drop the Member table

mysql> drop table members;
Query OK, 0 rows affected (0.08 sec)


4) Create the table Member again as per the schema description with the
following constraints.
a. Member_Id – Primary Key
b. Membership_type - ‘Lifetime’,’ Annual’, ‘Half Yearly’,’ Quarterly’

mysql> create table members
    -> (Member_id int primary key,
    -> Member_Name varchar(30),
    -> Member_address varchar(50),
    -> Acc_Open_Date date,
    -> Membership_type varchar(20),
    -> Fees_paid int,
    -> Max_Books_Allowed int,
    -> Penalty_Amount decimal(7,2));
Query OK, 0 rows affected (0.08 sec)

mysql> alter table members
    -> modify column Membership_type varchar(20) check (Membership_type in ('Lifetime', 'Annual', 'Half Yearly', 'Quarterly'));
Query OK, 0 rows affected (0.17 sec)
Records: 0  Duplicates: 0  Warnings: 0


5) Modify the table Member increase the width of the member name to 30
characters.
mysql> alter table members
    -> modify column Member_Name varchar(30);
Query OK, 0 rows affected (0.07 sec)
Records: 0  Duplicates: 0  Warnings: 0


6) Add a column named as Reference of Char(30) to Issue table.

mysql> alter table issue
    -> add column Reference char(30);
Query OK, 0 rows affected (0.14 sec)
Records: 0  Duplicates: 0  Warnings: 0


7) Delete/Drop the column Reference from Issue.
mysql> alter table issue
    -> drop column Reference;
Query OK, 0 rows affected (0.12 sec)
Records: 0  Duplicates: 0  Warnings: 0


8) Rename the table Issue to Lib_Issue.
mysql> alter table issue rename to Lib_issue;
Query OK, 0 rows affected (0.02 sec)


9) Insert following data in table Member

| Member_ID | Member_Name  | Member_Address | Acc_Open_Date | Membership_type | Fees_Paid | Max_Books_Allowed | Penalty_Amount |
| --------- | ------------ | -------------- | ------------- | --------------- | --------- | ----------------- | -------------- |
| 1         | Richa Sharma | Pune           | 10-12-05      | Lifetime        | 25000     | 5                 | 50             |
| 2         | Garima Sen   | Pune           | Current Date  | Annual          | 1000      | 3                 | NULL           |

mysql> insert into members values
    -> (1, 'Richa Sharma', 'Pune', '2005-12-10', 'Lifetime', 25000, 5, 50),
    -> (2, 'Garima Sen', 'Pune', CURRENT_DATE(), 'Annual', 1000, 3, NULL);
Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0


10) Insert at least 5 records with suitable data.

mysql> insert into members values
    -> (3, 'Ajay Giri', 'Mumbai', '2023-03-15', 'Half Yearly', 1500, 4, 20),
    -> (4, 'Nikhil Akolkar', 'Delhi', '2022-07-01', 'Quarterly', 500, 2, 10),
    -> (5, 'Suresh Kumar', 'Chennai', '2024-01-20', 'Annual', 1200, 3, NULL),
    -> (6, 'Prajyot Mane', 'Chennai', '2024-01-20', 'Annual', 1200, 3, NULL);
Query OK, 4 rows affected (0.01 sec)
Records: 4  Duplicates: 0  Warnings: 0


11) Modify the column Member_name. Decrease the width of the member
name to 20 characters. (If it does not allow state the reason for that)

mysql> alter table members
    -> modify column Member_Name varchar(20);
Query OK, 7 rows affected (0.05 sec)
Records: 7  Duplicates: 0  Warnings: 0


12) Add the constraints on columns max_books_allowed and penalty_amt
as follows
a. max_books_allowed < 100
b. penalty_amt maximum 1000
Also give names to the constraints.

mysql> alter table members
    -> add constraint chk_max_book_allowed check(Max_Books_Allowed < 100 ),
    -> add constraint chk_penalty_amt check(Penalty_Amount <= 1000 );
Query OK, 7 rows affected (0.06 sec)
Records: 7  Duplicates: 0  Warnings: 0



13) Try to insert a record with Max_Books_Allowed = 110, Observe the
error that comes.

mysql> insert into members values
    -> (8,"Sahil More", "Nagar", "2023-11-10", "Half Yearly", 1500, 110, 20);
ERROR 3819 (HY000): Check constraint 'chk_max_book_allowed' is violated.
mysql>

14) Generate another table named Member101 using a Create command
along with a simple SQL query on member table.

15) Drop the table books.
mysql> drop table members;
Query OK, 0 rows affected (0.08 sec)



16) Create table Books again as per the schema description with the
following constraints.
a. Book_No – Primary Key
b. Book_Name – Not Null
c. Category – System, Fiction, Database, RDBMS, Others.

mysql> create table Books
    -> (Book_no int primary key,
    -> Book_Name varchar(30) not null,
    -> Author_name varchar(30),
    -> Cost decimal(7,2),
    -> Category char(10) check ( Category in ("System", "Fiction", "Database", "RDBMS", "Other")));
Query OK, 0 rows affected (0.02 sec)



17) Insert data in Book table as follows:
| Book_No | Book_Name             | Author        | Cost | Category |
| ------- | --------------------- | ------------- | ---- | -------- |
| 101     | Let Us C              | Denis Ritchie | 450  | System   |
| 102     | Oracle – Complete Ref | Loni          | 550  | Database |
| 103     | Mastering SQL         | Loni          | 250  | Database |
| 104     | PL SQL – Ref          | Scott Urman   | 750  | Database |

mysql> insert into Books values (101, "Let us C", "Denis Ritchie", 450, "System"),
    -> (102, "Oracle Complete Ref", "Loni", 550, "Database"),
    -> (103, "Mastering SQL", "Loni", 250, "Database"),
    -> (104, "Pl SQL Ref", "Scott Urman", 750, "Database");
Query OK, 4 rows affected (0.04 sec)
Records: 4  Duplicates: 0  Warnings: 0



18) Insert more records in Book table.

mysql> insert into Books values
    -> (105, 'Operating System Concepts', 'Galvin', 850, 'System'),
    -> (106, 'The Alchemist', 'Paulo Coelho', 300, 'Fiction'),
    -> (107, 'Database System Concepts', 'Silberschatz', 950, 'RDBMS'),
    -> (108, 'Networking Basics', 'James Kurose', 600, 'Other');
Query OK, 4 rows affected (0.04 sec)
Records: 4  Duplicates: 0  Warnings: 0


19) View the data in the tables using simple SQL query.


mysql> select * from members;
+-----------+--------------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
| Member_id | Member_Name        | Member_address | Acc_Open_Date | Membership_type | Fees_paid | Max_Books_Allowed | Penalty_Amount |
+-----------+--------------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
|         1 | Richa Sharma       | Pune           | 2005-12-10    | Lifetime        |     25000 |                 5 |          50.00 |
|         2 | Garima Sen         | Pune           | 2025-11-25    | Annual          |      1000 |                 3 |           NULL |
|         3 | Ajay Giri          | Mumbai         | 2023-03-15    | Half Yearly     |      1500 |                 4 |          20.00 |
|         4 | Nikhil Akolkar     | Delhi          | 2022-07-01    | Quarterly       |       500 |                 2 |          10.00 |
|         5 | Suresh Kumar       | Chennai        | 2024-01-20    | Annual          |      1200 |                 3 |           NULL |
|         6 | Prajyot Mane       | Chennai        | 2024-01-20    | Annual          |      1200 |                 3 |           NULL |
|         7 | Shrikant Dahatonde | Banglore       | 2023-11-05    | Lifetime        |     30000 |                 6 |           0.00 |
+-----------+--------------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
7 rows in set (0.00 sec)

mysql> select * from books;
+---------+---------------------------+---------------+--------+----------+
| Book_no | Book_Name                 | Author_name   | Cost   | Category |
+---------+---------------------------+---------------+--------+----------+
|     101 | Let us C                  | Denis Ritchie | 450.00 | System   |
|     102 | Oracle Complete Ref       | Loni          | 550.00 | Database |
|     103 | Mastering SQL             | Loni          | 250.00 | Database |
|     104 | Pl SQL Ref                | Scott Urman   | 750.00 | Database |
|     105 | Operating System Concepts | Galvin        | 850.00 | System   |
|     106 | The Alchemist             | Paulo Coelho  | 300.00 | Fiction  |
|     107 | Database System Concepts  | Silberschatz  | 950.00 | RDBMS    |
|     108 | Networking Basics         | James Kurose  | 600.00 | Other    |
+---------+---------------------------+---------------+--------+----------+
8 rows in set (0.00 sec)

mysql>



20) Insert into Book following data.
105, National Geographic, Adis Scott, 1000, Science

mysql> insert into books
    -> values(110, "National Geographical", "Adis Scott", 1000, "Science");
ERROR 3819 (HY000): Check constraint 'books_chk_1' is violated.
mysql>


21) Rename the table Lib_Issue to Issue.

mysql> alter table Lib_issue rename to Issue;
Query OK, 0 rows affected (0.07 sec)



22) Drop table Issue.
mysql> drop table issue;
Query OK, 0 rows affected (0.03 sec)


23) As per the given structure Create table Issue again with following
constraints.

 Lib_Issue_Id-Primary key
 Book_No- foreign key
 Member_id - foreign key
 Issue_date
 Return_date


mysql> create table issue
    -> (Lib_issue_id int primary key,
    -> Book_No int,
    -> Member_ID int,
    -> Issue_date date,
    -> Return_date date);
Query OK, 0 rows affected (0.07

mysql> alter table issue
    -> add foreign key (Book_no)
    -> references books(Book_no);
Query OK, 0 rows affected (0.19 sec)
Records: 0  Duplicates: 0  Warnings: 0


mysql> alter table issue
    -> add foreign key (Member_Id)
    -> references members(Member_ID);
Query OK, 0 rows affected (0.18 sec)
Records: 0  Duplicates: 0  Warnings: 0



24) Insert following data into Issue table.
| Lib_Issue_Id | Book_No | Member_ID | Issue_Date |
| ------------ | ------- | --------- | ---------- |
| 7001         | 101     | 1         | 10-Dec-06  |
| 7002         | 102     | 2         | 25-Dec-06  |
| 7003         | 104     | 1         | 15-Jan-06  |
| 7004         | 101     | 1         | 04-Jul-06  |
| 7005         | 104     | 2         | 15-Nov-06  |
| 7006         | 101     | 3         | 18-Feb-06  |



mysql> insert into issue (Lib_issue_id, Book_no, Member_id, Issue_date) values
    -> (7001, 101, 1, '2006-12-10'),
    -> (7002, 102, 2, '2006-12-25'),
    -> (7003, 104, 1, '2006-01-15'),
    -> (7004, 101, 1, '2006-07-04'),
    -> (7005, 104, 2, '2006-11-15'),
    -> (7006, 101, 3, '2006-02-18');
Query OK, 6 rows affected (0.04 sec)
Records: 6  Duplicates: 0  Warnings: 0

mysql> select * from issue;
+--------------+---------+-----------+------------+-------------+
| Lib_issue_id | Book_No | Member_ID | Issue_date | Return_date |
+--------------+---------+-----------+------------+-------------+
|         7001 |     101 |         1 | 2006-12-10 | NULL        |
|         7002 |     102 |         2 | 2006-12-25 | NULL        |
|         7003 |     104 |         1 | 2006-01-15 | NULL        |
|         7004 |     101 |         1 | 2006-07-04 | NULL        |
|         7005 |     104 |         2 | 2006-11-15 | NULL        |
|         7006 |     101 |         3 | 2006-02-18 | NULL        |
+--------------+---------+-----------+------------+-------------+
6 rows in set (0.00 sec)



25) Remove the constraints on Issue table
mysql> set foreign_key_checks = 0;
Query OK, 0 rows affected (0.01 sec)

mysql>


26) Insert a record in Issue table. The member_id should not exist in
member table.

mysql> insert into issue (Lib_issue_id, Book_no, Member_id, Issue_date) values
    -> (7010, 104, 10, '2025-11-26');
Query OK, 1 row affected (0.04 sec)

mysql> insert into issue (Lib_issue_id, Book_no, Member_id, Issue_date) values
    -> (7011, 101, 11, '2010-10-26');
ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails (`assignment_2`.`issue`, CONSTRAINT `issue_ibfk_2` FOREIGN KEY (`Member_ID`) REFERENCES `members` (`Member_id`))
mysql>



27) Now enable the constraints of Issue table. Observe the error
mysql> set foreign_key_checks = 1;
Query OK, 0 rows affected (0.01 sec)



28) Delete the record inserted at Q-27) and enable the constraints.

mysql> delete from issue where member_id = 10;
Query OK, 1 row affected (0.04 sec)



29) Try to delete the record of member id 1 from member table and
observe the error .

mysql> delete from members where member_id = 1;
ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails (`assignment_2`.`issue`, CONSTRAINT `issue_ibfk_2` FOREIGN KEY (`Member_ID`) REFERENCES `members` (`Member_id`))
mysql>


30) View the data and structure of all the three tables Member,
Issue, Book.

mysql> select * from members;
+-----------+--------------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
| Member_id | Member_Name        | Member_address | Acc_Open_Date | Membership_type | Fees_paid | Max_Books_Allowed | Penalty_Amount |
+-----------+--------------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
|         1 | Richa Sharma       | Pune           | 2005-12-10    | Lifetime        |     25000 |                 5 |          50.00 |
|         2 | Garima Sen         | Pune           | 2025-11-25    | Annual          |      1000 |                 3 |           NULL |
|         3 | Ajay Giri          | Mumbai         | 2023-03-15    | Half Yearly     |      1500 |                 4 |          20.00 |
|         4 | Nikhil Akolkar     | Delhi          | 2022-07-01    | Quarterly       |       500 |                 2 |          10.00 |
|         5 | Suresh Kumar       | Chennai        | 2024-01-20    | Annual          |      1200 |                 3 |           NULL |
|         6 | Prajyot Mane       | Chennai        | 2024-01-20    | Annual          |      1200 |                 3 |           NULL |
|         7 | Shrikant Dahatonde | Banglore       | 2023-11-05    | Lifetime        |     30000 |                 6 |           0.00 |
+-----------+--------------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
7 rows in set (0.00 sec)

mysql> select * from books;
+---------+---------------------------+---------------+--------+----------+
| Book_no | Book_Name                 | Author_name   | Cost   | Category |
+---------+---------------------------+---------------+--------+----------+
|     101 | Let us C                  | Denis Ritchie | 450.00 | System   |
|     102 | Oracle Complete Ref       | Loni          | 550.00 | Database |
|     103 | Mastering SQL             | Loni          | 250.00 | Database |
|     104 | Pl SQL Ref                | Scott Urman   | 750.00 | Database |
|     105 | Operating System Concepts | Galvin        | 850.00 | System   |
|     106 | The Alchemist             | Paulo Coelho  | 300.00 | Fiction  |
|     107 | Database System Concepts  | Silberschatz  | 950.00 | RDBMS    |
|     108 | Networking Basics         | James Kurose  | 600.00 | Other    |
+---------+---------------------------+---------------+--------+----------+
8 rows in set (0.00 sec)

mysql> select * from issue;
+--------------+---------+-----------+------------+-------------+
| Lib_issue_id | Book_No | Member_ID | Issue_date | Return_date |
+--------------+---------+-----------+------------+-------------+
|         7001 |     101 |         1 | 2006-12-10 | NULL        |
|         7002 |     102 |         2 | 2006-12-25 | NULL        |
|         7003 |     104 |         1 | 2006-01-15 | NULL        |
|         7004 |     101 |         1 | 2006-07-04 | NULL        |
|         7005 |     104 |         2 | 2006-11-15 | NULL        |
|         7006 |     101 |         3 | 2006-02-18 | NULL        |
+--------------+---------+-----------+------------+-------------+
6 rows in set (0.00 sec)

mysql> desc members;
+-------------------+--------------+------+-----+---------+-------+
| Field             | Type         | Null | Key | Default | Extra |
+-------------------+--------------+------+-----+---------+-------+
| Member_id         | int          | NO   | PRI | NULL    |       |
| Member_Name       | varchar(20)  | YES  |     | NULL    |       |
| Member_address    | varchar(50)  | YES  |     | NULL    |       |
| Acc_Open_Date     | date         | YES  |     | NULL    |       |
| Membership_type   | varchar(20)  | YES  |     | NULL    |       |
| Fees_paid         | int          | YES  |     | NULL    |       |
| Max_Books_Allowed | int          | YES  |     | NULL    |       |
| Penalty_Amount    | decimal(7,2) | YES  |     | NULL    |       |
+-------------------+--------------+------+-----+---------+-------+
8 rows in set (0.01 sec)

mysql> desc books;
+-------------+--------------+------+-----+---------+-------+
| Field       | Type         | Null | Key | Default | Extra |
+-------------+--------------+------+-----+---------+-------+
| Book_no     | int          | NO   | PRI | NULL    |       |
| Book_Name   | varchar(30)  | NO   |     | NULL    |       |
| Author_name | varchar(30)  | YES  |     | NULL    |       |
| Cost        | decimal(7,2) | YES  |     | NULL    |       |
| Category    | char(10)     | YES  |     | NULL    |       |
+-------------+--------------+------+-----+---------+-------+
5 rows in set (0.00 sec)

mysql> desc issue;
+--------------+------+------+-----+---------+-------+
| Field        | Type | Null | Key | Default | Extra |
+--------------+------+------+-----+---------+-------+
| Lib_issue_id | int  | NO   | PRI | NULL    |       |
| Book_No      | int  | YES  | MUL | NULL    |       |
| Member_ID    | int  | YES  | MUL | NULL    |       |
| Issue_date   | date | YES  |     | NULL    |       |
| Return_date  | date | YES  |     | NULL    |       |
+--------------+------+------+-----+---------+-------+
5 rows in set (0.00 sec)

mysql>



31) Modify the Return_Date of 7004,7005 to 15 days after the
Issue_date.

mysql> update issue set return_date = '2006-07-19' where Lib_issue_id = 7004;
Query OK, 1 row affected (0.04 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> update issue set return_date = '2006-11-30' where Lib_issue_id = 7005;
Query OK, 1 row affected (0.04 sec)
Rows matched: 1  Changed: 1  Warnings: 0



32) Remove all the records from Issue table where member_ID is 1
and Issue date in before 10-Dec-06.

mysql> delete from issue where member_id = 1 and Issue_date < '2006-12-10';
Query OK, 2 rows affected (0.04 sec)


33) Remove all the records from Book table with category other
than RDBMS and Database.

mysql> delete from books
    -> where category not in ('RDBMS','Database');
ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails (`assignment_2`.`issue`, CONSTRAINT `issue_ibfk_1` FOREIGN KEY (`Book_No`) REFERENCES `books` (`Book_no`))
mysql>



34) Remove the table Member.
mysql> drop table members;


35) Remove the table Book.
mysql> drop table books;
